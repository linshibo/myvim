package main
import(
    //"math/rand"
    "time"
    "fmt"
    "./bufferManager"
)

func foo(buf []byte){
    var m int
    //count:= rand.Intn(10000)+10000
    for i:=0; i<100000;i++{
        m+=i
    }
}

func main(){
    x := bufferManager.NewBufferManager()
    tt:=time.Now()
    for i:=0; i<500000;i++{
        b:=x.GetBuffer()
        foo(b)
        x.RecycleBuffer(b)
    }
    fmt.Println("---------------------- buffered", time.Since(tt))
    time.Sleep(10)
    tt=time.Now()
    for i:=0; i<500000;i++{
        b:=make([]byte, 102400)
        foo(b)
    }
    fmt.Println("---------------------- unbuffered", time.Since(tt))
    time.Sleep(10)
}
